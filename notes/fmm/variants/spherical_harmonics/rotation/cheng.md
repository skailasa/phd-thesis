Basically a good a place as any to summarise analytical 3D FMM

$$
Y_n^m(\theta, \phi) = \sqrt{\frac{(n-|m|)!}{(n+|m|)!}} \cdot P_n^{|m|} (\cos{\theta})e^{i m \phi}
$$

Rodrigues formula for associated legendre polynomials

$$
P^m_n(x) = (-1)^m(1-x^2)^{m/2} \frac{d^m}{dx^m}P_n(x)
$$

Where $P_n4 are the legendre polynomials.

Theorem (Multipole)

$N$ charges located in a sphere of radius $a$ at origin, then for any point with $r > a$ (i.e. outside of area where there could be a singularity) the potential generated by these charges is given by,

$$
\Phi(x) = \sum_{n=0}^\infty \sum_{m=-n}^n \frac{M_n^m}{r^{n+1}} \cdot Y_n^m(\theta, \phi)
$$

Where

$$
M_n^m = \sum_{i=1}^N q_i \rho_i^n Y_n^{-m}
$$

Error bound (7) showing exponential convergence with $p$.

Actually a good reference containing M2L operators too.

Rotation Operators
- Proofs found in
    - 5. L. C. Biedenharn and J. D. Louck, Angular Momentum in Quantum Physics: Theory and Application (AddisonWesley, Reading, MA, 1981)


- $e$ and $\omega$ are two sets of orthonormal vectors in $\mathbb{R}^3$ that both form bases.

And you have a harmonic function represented with a multipole expansion


$$
\Phi(x) = \sum_{n=0}^p \sum_{m=-n}^n \frac{M_n^m}{r^{n+1}} \cdot Y_n^m(\theta, \phi)
$$

Associated with first basis $e$. Then there are coefficients $R_n^{m,m'}$ with $n=0,1...p$ $m=-n,...,n$ $m'=-n...n$

Such that at any target point

$$
\Phi(x) = \sum_{n=0}^p \sum_{m'=-n}^n \frac{\tilde{M}_n^{m'}}{r^{n+1}} \cdot Y_n^{m'}(\theta, \phi)
$$

Where the dashed coordinates are in the rotated bases

$$
\tilde{M}_n^{m'} = \sum_{m=-n}^n R_n^{m,m'} M_n^m
$$

rotation poerator from above formula is of $O(p^3)$



Exponential/plane-wave Representation

$$
\frac{1}{r} = \frac{1}{2\pi}  \int_0^\infty e^{-\lambda (z-z_0)} \int_0^{2\pi} e^{i\lambda ((x-x_0)\cos{\alpha} + (y-y_0)\sin{\alpha})}
$$


Source marked with 0, target not, z > z_0 r is modulus of distance between source and target.

Describes an exponentially decaying function in z direction, oscillating in x/y plane as a plane wave

- cylindracal coords

superposition of plane waves with different wavelengths lambda

Equation 29 gives an error bound for number of expansion terms required for this expansion in this basis

Comes from solution of Laplace in cylindrical polars, z term is axial solution
x-y term is plane wave solution, comes form Bessel function of 0th order

https://www.wolframalpha.com/input?i=Zeroth+order+bessel+function


When an expansion is translated along its z axis the cost is reduced to O(p^3) form O(p^4)

- point and shoot

Can use point and shoot for M2M and L2L and special plane-wave based translations for M2L


The translation operators are diagonal for the plane wave representation.

The procedure of the preceding section has been further accelerated. First,
symmetry considerations can be used to reduce the number of translations per box from 189
to 40 without any loss of precision

 L. Greengard and V. Rokhlin, A new version of the fast multipole method for the Laplace equation in three
dimensions, Acta Numerica 6, 229 (1997)

 - Can reduce int list to less than 40 using expontential expansions and relies on the diagonal form of the operators.
